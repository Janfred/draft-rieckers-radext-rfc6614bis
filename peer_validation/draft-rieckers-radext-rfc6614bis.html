<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Transport Layer Security (TLS) Encryption for RADIUS</title>
<meta content="Jan-Frederik Rieckers" name="author">
<meta content="Stefan Winter" name="author">
<meta content="
       This document specifies a transport profile for RADIUS using Transport Layer Security (TLS) over TCP as the transport protocol.
This enables dynamic trust relationships between RADIUS servers as well as encrypting RADIUS traffic between servers using a shared secret. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="RADIUS" name="keyword">
<meta content="TLS" name="keyword">
<meta content="draft-rieckers-radext-rfc6614bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.10
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-rieckers-radext-rfc6614bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RADIUS over TLS</td>
<td class="right">March 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Rieckers &amp; Winter</td>
<td class="center">Expires 11 September 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RADIUS EXTensions</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-rieckers-radext-rfc6614bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6614" class="eref">6614</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-03-10" class="published">10 March 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-09-11">11 September 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J.-F. Rieckers, <span class="editor">Ed.</span>
</div>
<div class="org">DFN</div>
</div>
<div class="author">
      <div class="author-name">S. Winter</div>
<div class="org">RESTENA</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Transport Layer Security (TLS) Encryption for RADIUS</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a transport profile for RADIUS using Transport Layer Security (TLS) over TCP as the transport protocol.
This enables dynamic trust relationships between RADIUS servers as well as encrypting RADIUS traffic between servers using a shared secret.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-rieckers-radext-rfc6614bis/">https://datatracker.ietf.org/doc/draft-rieckers-radext-rfc6614bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        RADIUS EXTensions Working Group mailing list (<span><a href="mailto:radext@ietf.org">mailto:radext@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/radext/">https://mailarchive.ietf.org/arch/browse/radext/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/radext/">https://www.ietf.org/mailman/listinfo/radext/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 September 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-changes-from-rfc6614" class="internal xref">Changes from RFC6614</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-transport-layer-security-fo" class="internal xref">Transport layer security for RADIUS/TCP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-tcp-port-and-packet-types" class="internal xref">TCP port and Packet Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-tls-connection-setup" class="internal xref">TLS Connection setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-tls-peer-authentication" class="internal xref">TLS Peer Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-authentication-using-x509-c" class="internal xref">Authentication using X.509 certificates with PKIX trust model</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-authentication-using-certif" class="internal xref">Authentication using certificate fingerprints</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="auto internal xref">2.3.3</a>.  <a href="#name-authentication-using-tls-ps" class="internal xref">Authentication using TLS-PSK</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.4">
                    <p id="section-toc.1-1.2.2.3.2.4.1"><a href="#section-2.3.4" class="auto internal xref">2.3.4</a>.  <a href="#name-authentication-using-raw-pu" class="internal xref">Authentication using Raw Public Keys</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-connecting-client-identity" class="internal xref">Connecting Client Identity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-radius-datagrams" class="internal xref">RADIUS Datagrams</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-design-decisions" class="internal xref">Design Decisions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-implications-of-dynamic-pee" class="internal xref">Implications of Dynamic Peer Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-x509-certificate-considerat" class="internal xref">X.509 Certificate Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-cipher-suites-and-compressi" class="internal xref">Cipher Suites and Compression Negotiation Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-radius-datagram-considerati" class="internal xref">RADIUS Datagram Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-compatibility-with-other-ra" class="internal xref">Compatibility with Other RADIUS Transports</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-lessons-learned-from-deploy" class="internal xref">Lessons learned from deployments of the Experimental RFC6614</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-eduroam" class="internal xref">eduroam</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-wireless-broadband-alliance" class="internal xref">Wireless Broadband Alliance's OpenRoaming</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-participating-in-more-than-" class="internal xref">Participating in more than one roaming consortium</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-interoperable-implementatio" class="internal xref">Interoperable Implementations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-backward-compatibility" class="internal xref">Backward compatibility</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The RADIUS protocol <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> is a widely deployed authentication and authorization protocol.
The supplementary RADIUS Accounting specification <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>]</span> provides accounting mechanisms, thus delivering a full Authentication, Authorization, and Accounting (AAA) solution.
However, RADIUS has shown several shortcomings, especially the lack of security for large parts of its packet payload.
RADIUS security is based on the MD5 algorithm, which has been proven to be insecure.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The main focus of RADIUS over TLS is to provide a means to secure the communication between RADIUS/TCP peers using TLS.
The most important use of this specification lies in roaming environments where RADIUS packets need to be transferred through different administrative domains and untrusted, potentially hostile network.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">There are multiple known attacks on the MD5 algorithm that is used in RADIUS to provide integrity protection and a limited confidentiality protection. RADIUS over TLS wraps the entire RADIUS packet payload into a TLS stream and thus mitigates the risk of attacks on MD5.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Because of the static trust establishment between RADIUS peers (IP address and shared secret), the only scalable way of creating a massive deployment of RADIUS servers under the control of different administrative entities is to introduce some form of a proxy chain to route the access requests to their home server.
This creates a lot of overhead in terms of possible points of failure, longer transmission times, as well as middleboxes through which authentication traffic flows.
These middleboxes may learn privacy-relevant data while forwarding requests.
The new features in RADIUS over TLS add a new way to identify other peers, e.g., by checking a certificate for the issuer or other certificate properties, but also provides a simple upgrade path for existing RADIUS connection by simply using the shared secret to authenticate the TLS session.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="conventions-and-definitions">
<section id="section-1.1">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Within this document we will use the following terms:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1">RADIUS/TLS node:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">a RADIUS-over-TLS client or server<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">RADIUS/TLS Client:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">a RADIUS-over-TLS instance that initiates a new connection<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">RADIUS/TLS Server:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.6">
            <p id="section-1.1-3.6.1">a RADIUS-over-TLS instance that listens on a RADIUS-over-TLS port and accepts new connections<a href="#section-1.1-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">RADIUS/UDP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.8">
            <p id="section-1.1-3.8.1">a classic RADIUS transport over UDP as defined in <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span><a href="#section-1.1-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="changes-from-rfc6614">
<section id="section-1.2">
        <h3 id="name-changes-from-rfc6614">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-changes-from-rfc6614" class="section-name selfRef">Changes from RFC6614</a>
        </h3>
<p id="section-1.2-1">Currently, there are no big changes, since this is just a restructured spec from <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">The following things have changed:<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.2-3">
          <dt id="section-1.2-3.1">Required TLS versions:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.2">
            <p id="section-1.2-3.2.1">TLS 1.2 is now the minimum TLS version, TLS 1.3 is included as recommended.<a href="#section-1.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.3">TLS compression:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.4">
            <p id="section-1.2-3.4.1"><span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> allowed usage of TLS compression, this document forbids it.<a href="#section-1.2-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.5">TLS-PSK support:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.6">
            <p id="section-1.2-3.6.1"><span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> lists support for TLS-PSK as <span class="bcp14">OPTIONAL</span>, this document changes this to <span class="bcp14">RECOMMENDED</span>.<a href="#section-1.2-3.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-3.7">Mandatory-to-implement(MTI) cipher suites:</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-3.8">
            <p id="section-1.2-3.8.1">Following the recommendation from <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span>, the RC4 cipher suite is no longer included as <span class="bcp14">SHOULD</span>, and the AES cipher suite is the new MTI cipher suite, since it is the MTI cipher suite from TLS 1.2.
Additionally, this document references <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span> for further recommendations for cipher suites.<a href="#section-1.2-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-4">The following things will change in future versions of this draft:<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-5.1">Usage of Server Name Indication<a href="#section-1.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-5.2">More text for TLS-PSK<a href="#section-1.2-5.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="transport-layer-security-for-radiustcp">
<section id="section-2">
      <h2 id="name-transport-layer-security-fo">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-transport-layer-security-fo" class="section-name selfRef">Transport layer security for RADIUS/TCP</a>
      </h2>
<p id="section-2-1">This section specifies the way TLS is used to secure the traffic and the changes in the handling of RADIUS packets.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="tcp-port-and-packet-types">
<section id="section-2.1">
        <h3 id="name-tcp-port-and-packet-types">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-tcp-port-and-packet-types" class="section-name selfRef">TCP port and Packet Types</a>
        </h3>
<p id="section-2.1-1">The default destination port number for RADIUS over TLS is TCP/2083.
There are no separate ports for authentication, accounting, and dynamic authorization changes.
The source port is arbitrary.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-connection-setup">
<section id="section-2.2">
        <h3 id="name-tls-connection-setup">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-tls-connection-setup" class="section-name selfRef">TLS Connection setup</a>
        </h3>
<p id="section-2.2-1">The RADIUS/TLS nodes first try to establish a TCP connection as per <span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span>.
Failure to connect leads to continuous retries.
It is <span class="bcp14">RECOMMENDED</span> to use exponentially growing intervals between every try.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">After completing the TCP handshake, the RADIUS/TLS nodes immediately negotiate a TLS session.
The following restrictions apply:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">Support for TLS 1.2 <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> is <span class="bcp14">REQUIRED</span>, support for TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> is <span class="bcp14">RECOMMENDED</span>.
RADIUS/TLS nodes <span class="bcp14">MUST NOT</span> negotiate TLS versions prior to TLS 1.2.<a href="#section-2.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-3.2">The RADIUS/TLS nodes <span class="bcp14">MUST NOT</span> offer or negotiate cipher suites which do not provide confidentiality and integrity protection.<a href="#section-2.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-3.3">The RADIUS/TLS nodes <span class="bcp14">MUST NOT</span> negotiate compression.<a href="#section-2.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-3.4">When using TLS 1.3, RADIUS/TLS nodes <span class="bcp14">MUST NOT</span> use early data (<span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, Section 2.3)<a href="#section-2.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-3.5">RADIUS/TLS implementations <span class="bcp14">MUST</span>, at minimum, support negotiation of the TLS_RSA_WITH_AES_128_CBC_SHA cipher suite and <span class="bcp14">SHOULD</span> follow the recommendations for supported cipher suites in <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span>, Section 4.<a href="#section-2.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-3.6">In addition, RADIUS/TLS implementations <span class="bcp14">MUST</span> support negotiation of the mandatory-to-implement cipher suites required by the versions of TLS they support.<a href="#section-2.2-3.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-4">Details for peer authentication are described in <a href="#TLSPeerAuth" class="auto internal xref">Section 2.3</a>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">After successful negotiation of a TLS session, the RADIUS/TLS peers can start exchanging RADIUS datagrams.
The shared secret to compute the (obsolete) MD5 integrity checks and attribute obfuscation <span class="bcp14">MUST</span> be "radsec".<a href="#section-2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="TLSPeerAuth">
<section id="section-2.3">
        <h3 id="name-tls-peer-authentication">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-tls-peer-authentication" class="section-name selfRef">TLS Peer Authentication</a>
        </h3>
<p id="section-2.3-1">Peers <span class="bcp14">MUST</span> mutually authenticate each other at the TLS layer.
The authentication of peers can be done using different models, that will be described here.
Peers can also perform additional authorization checks based on non-TLS information. For example, verifying that the client IP address (source IP address of the TLS connection) falls within a particular network range.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="authentication-using-x509-certificates-with-pkix-trust-model">
<section id="section-2.3.1">
          <h4 id="name-authentication-using-x509-c">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-authentication-using-x509-c" class="section-name selfRef">Authentication using X.509 certificates with PKIX trust model</a>
          </h4>
<p id="section-2.3.1-1">All RADIUS/TLS implementations <span class="bcp14">MUST</span> implement this model, following the following rules:<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.1-2.1">Implementations <span class="bcp14">MUST</span> allow the configuration of a list of trusted Certificate Authorities for incoming connections.<a href="#section-2.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.1-2.2">Certificate validation <span class="bcp14">MUST</span> include the verification rules as per <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-2.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.1-2.3">Implementations <span class="bcp14">SHOULD</span> indicate their trusted Certification Authorities (CAs). See <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>, Section 7.4.4 and <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span>, Section 6 for TLS 1.2 and <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, Section 4.2.4 for TLS 1.3.<a href="#section-2.3.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.1-2.4">
              <p id="section-2.3.1-2.4.1">RADIUS/TLS clients validate the server identity to match their local configuration:<a href="#section-2.3.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.1-2.4.2.1">If the expected RADIUS/TLS server was configured as a hostname, the configured name is matched against the presented names from the subjectAltName:DNS extension; if no such exist, against the presented CN component of the certificate subject.<a href="#section-2.3.1-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.3.1-2.4.2.2">If the expected RADIUS/TLS server was configured as an IP address, the configured IP address is matched against the presented addresses in the subjectAltName:iPAddr extension; if no such exist, against the presented CN component of the certificate subject.<a href="#section-2.3.1-2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.3.1-2.4.2.3">If the expected RADIUS/TLS server was not configured but discovered as per <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span>, the realm which was used as input to the discovery is matched against the presented realm names from the subjectAltName:naiRealm extension; if no such extension is present, the certificate is accepted without further name checks immediately after the <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> trust chain checks.<span class="cref" id="discovery">The discovery may output a SRV record with hostnames. Maybe it is a good idea to check against those hostnames in addition to the NAIRealm.<span class="crefSource">Janfred</span></span><a href="#section-2.3.1-2.4.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.3.1-2.5">
              <p id="section-2.3.1-2.5.1">RADIUS/TLS server validate the incoming certificate against a local database of acceptable clients. The database may enumerate acceptable clients either by IP address or by a name component in the certificate.<a href="#section-2.3.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3.1-2.5.2.1">For clients configured by name, the configured name is matched against the presented names from the subjectAltName:DNS extension; if no such exists, against the presented CN component in the certificate subject.<a href="#section-2.3.1-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.3.1-2.5.2.2">For clients configured by their source IP address, the configured IP address is matched against the presented addresses in the subjectAltName:iPAddr extension; if no such exist, against the presented CN component of the certificate subject.<a href="#section-2.3.1-2.5.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.3.1-2.5.2.3">It is possible for a RADIUS/TLS server to not require additional name checks for incoming RADIUS/TLS clients. In this case, the certificate is accepted immediately after the <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> trust chain checks. This <span class="bcp14">MUST NOT</span> be used outside of trusted network environments or without additional certificate attribute checks in place.<a href="#section-2.3.1-2.5.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.3.1-2.6">Implementations <span class="bcp14">MAY</span> allow the configuration of a set of additional properties of the certificate to check for a peer's authorization to communicate (e.g., a set of allowed values in subjectAltName:URI or a set of allowed X.509v3 Certificate Policies).<a href="#section-2.3.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.3.1-2.7">When the configured trust base changes (e.g., removal of a CA from the list of trusted CAs; issuance of a new CRL for a given CA), implementations <span class="bcp14">MAY</span> renegotiate the TLS session to reassess the connecting peer's continued authorization.<span class="cref" id="_5">Replace may with should here?<span class="crefSource">Janfred</span></span><a href="#section-2.3.1-2.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="authentication-using-certificate-fingerprints">
<section id="section-2.3.2">
          <h4 id="name-authentication-using-certif">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-authentication-using-certif" class="section-name selfRef">Authentication using certificate fingerprints</a>
          </h4>
<p id="section-2.3.2-1">RADIUS/TLS implementations <span class="bcp14">SHOULD</span> allow the configuration of a list of trusted certificates, identified via fingerprint of the DER encoded certificate octets.
When implementing this model, support for SHA-1 as hash algorithm for the fingerprint is <span class="bcp14">REQUIRED</span>, and support for the more contemporary has function SHA-256 is <span class="bcp14">RECOMMENDED</span>.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-using-tls-psk">
<section id="section-2.3.3">
          <h4 id="name-authentication-using-tls-ps">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-authentication-using-tls-ps" class="section-name selfRef">Authentication using TLS-PSK</a>
          </h4>
<p id="section-2.3.3-1">RADIUS/TLS implementations <span class="bcp14">SHOULD</span> support the use of TLS-PSK.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-using-raw-public-keys">
<section id="section-2.3.4">
          <h4 id="name-authentication-using-raw-pu">
<a href="#section-2.3.4" class="section-number selfRef">2.3.4. </a><a href="#name-authentication-using-raw-pu" class="section-name selfRef">Authentication using Raw Public Keys</a>
          </h4>
<p id="section-2.3.4-1">RADIUS/TLS implementations <span class="bcp14">SHOULD</span> support using Raw Public Keys <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span> for mutual authentication.<span class="cref" id="rpk">TODO: More text here.<span class="crefSource">Janfred</span></span><a href="#section-2.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="connecting-client-identity">
<section id="section-2.4">
        <h3 id="name-connecting-client-identity">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-connecting-client-identity" class="section-name selfRef">Connecting Client Identity</a>
        </h3>
<p id="section-2.4-1">In RADIUS/UDP, clients are uniquely identified by their IP address.
Since the shared secret is associated with the origin IP address, if more than one RADIUS client is associated with the same IP address, then those clients also must utilize the same shared secret.
This practice is inherently insecure, as noted in <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>, Section 5.3.2.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Following the different authentication modes presented in <a href="#TLSPeerAuth" class="auto internal xref">Section 2.3</a>, the identification of clients can be done by different means:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">In TLS-PSK operation, a client is uniquely identified by its PSK Identity.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">When using certificate fingerprints, a client is uniquely identified by the fingerprint of the presented client certificate.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">When using X.509 certificates with a PKIX trust model, a client is uniquely identified by the tuple of the serial number of the presended client certificate and the issuer of the client certificate.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<p id="section-2.4-6">Note well: having identified a connecting entity does not mean the server necessarily wants to communicate with that client.
For example, if the issuer is not in a trusted set of issuers, the server may decline to perform RADIUS transactions with this client.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
<p id="section-2.4-7">There are numerous trust models in PKIX environments, and it is beyond the scope of this document to define how a particular deployment determines whether a client is trustworthy.
Implementations that want to support a wide variety of trust models should expose as many details of the presented certificate to the administrator as possible so that the trust model can be implemented by the administrator.
As a suggestion, at least the following parameters of the X.509 client certificate should be exposed:<a href="#section-2.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-8.1">Originating IP address<a href="#section-2.4-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.2">Certificate Fingerprint<a href="#section-2.4-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.3">Issuer<a href="#section-2.4-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.4">Subject<a href="#section-2.4-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.5">all X.509v3 Extended Key Usage<a href="#section-2.4-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.6">all X.509v3 Subject Alternative Name<a href="#section-2.4-8.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-8.7">all X.509v3 Certificate Policies<a href="#section-2.4-8.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.4-9">For TLS-PSK operation, at least the following parameters of the TLS connection should be exposed:<a href="#section-2.4-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-10.1">Originating IP address<a href="#section-2.4-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-10.2">PSK Identity<a href="#section-2.4-10.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="radius-datagrams">
<section id="section-2.5">
        <h3 id="name-radius-datagrams">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-radius-datagrams" class="section-name selfRef">RADIUS Datagrams</a>
        </h3>
<p id="section-2.5-1">Authentication, Authorization, and Accounting packets are sent according to the following rules:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">RADIUS/TLS clients transmit the same packet types on the connection they initiated as a RADIUS/UDP client would.
For example, they send<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-3.1">Access-Request<a href="#section-2.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-3.2">Accounting-Request<a href="#section-2.5-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-3.3">Status-Server<a href="#section-2.5-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-3.4">Disconnect-ACK<a href="#section-2.5-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-3.5">Disconnect-NAK<a href="#section-2.5-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-3.6">...<a href="#section-2.5-3.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.5-4">RADIUS/TLS servers transmit the same packets on connections they have accepted as a RADIUS/UDP server would.
For example, they send<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-5.1">Access-Challenge<a href="#section-2.5-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-5.2">Access-Accept<a href="#section-2.5-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-5.3">Access-Reject<a href="#section-2.5-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-5.4">Accounting-Response<a href="#section-2.5-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-5.5">Disconnect-Request<a href="#section-2.5-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-5.6">...<a href="#section-2.5-5.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.5-6">Due to the use of one single TCP port for all packet types, it is required that a RADIUS/TLS server signal which types of packets are supported on a server to a connecting peer.<a href="#section-2.5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-7.1">When an unwanted packet of type 'CoA-Request' or 'Disconnect-Request' is received, a RADIUS/TLS server needs to respond with a 'CoA-NAK' or 'Disconnect-NAK', respectively.
The NAK <span class="bcp14">SHOULD</span> contain an attribute Error-Cause with the value 406 ("Unsupported Extension"); see <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span> for details.<a href="#section-2.5-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.5-7.2">When an unwanted packet of type 'Accounting-Request' is received, the RADIUS/TLS server <span class="bcp14">SHOULD</span> reply with an Accounting-Response containing an Error-Cause attribute with value 406 "Unsupported Extension" as defined in <span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span>.
A RADIUS/TLS accounting client receiving such an Accounting-Response <span class="bcp14">SHOULD</span> log the error and stop sending Accounting-Request packets to this server.<a href="#section-2.5-7.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="design-decisions">
<section id="section-3">
      <h2 id="name-design-decisions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-design-decisions" class="section-name selfRef">Design Decisions</a>
      </h2>
<p id="section-3-1">This section explains the design decisions that led to the rules defined in the previous section, as well as a reasoning behind the differences to <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="implications-of-dynamic-peer-discovery">
<section id="section-3.1">
        <h3 id="name-implications-of-dynamic-pee">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-implications-of-dynamic-pee" class="section-name selfRef">Implications of Dynamic Peer Discovery</a>
        </h3>
<p id="section-3.1-1">One mechanism to discover RADIUS-over-TLS peers dynamically via DNS is specified in <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span>.
While this mechanism is still under development and therefore is not a normative dependency of RADIUS/TLS, the use of dynamic discovery has potential future implications that are important to understand.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Readers of this document who are considering the deployment of DNS-based dynamic discovery are thus encouraged to read <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> and follow its future development.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cert_considerations">
<section id="section-3.2">
        <h3 id="name-x509-certificate-considerat">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-x509-certificate-considerat" class="section-name selfRef">X.509 Certificate Considerations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.2-1">
          <dt id="section-3.2-1.1">(1)</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-1.2">
            <p id="section-3.2-1.2.1">If a RADIUS/TLS client is in possession of multiple certificates from different CAs (i.e., is part of multiple roaming consortia) and dynamic discovery is used, the discovery mechanism possibly does not yield sufficient information to identify the consortium uniquely (e.g., DNS discovery).
Subsequently, the client may not know by itself which client certificate to use for the TLS handshake.
Then, it is necessary for the server to signal to which consortium it belongs and which certificates it expects.
If there is no risk of confusing multiple roaming consortia, providing this information in the handshake is not crucial.<a href="#section-3.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-1.3">(2)</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-1.4">
            <p id="section-3.2-1.4.1">If a RADIUS/TLS server is in possession of multiple certificates from different CAs (i.e., is part of multiple roaming consortia), it will need to select one of its certificates to present to the RADIUS/TLS client.
If the client sends the Trusted CA Indication, this hint can make the server select the appropriate certificate and prevent a handshake failure.
Omitting this indication makes it impossible to deterministically select the right certificate in this case.
If there is no risk of confusing multiple roaming consortia, providing this indication in the handshake is not crucial.<a href="#section-3.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cipher-suites-and-compression-negotiation-considerations">
<section id="section-3.3">
        <h3 id="name-cipher-suites-and-compressi">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-cipher-suites-and-compressi" class="section-name selfRef">Cipher Suites and Compression Negotiation Considerations</a>
        </h3>
<p id="section-3.3-1">See <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span> for considerations regarding the cipher suites and negotiation.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="datagram_considerations">
<section id="section-3.4">
        <h3 id="name-radius-datagram-considerati">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-radius-datagram-considerati" class="section-name selfRef">RADIUS Datagram Considerations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-3.4-1">
          <dt id="section-3.4-1.1">(1)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-1.2">
            <p id="section-3.4-1.2.1">After the TLS session is established, RADIUS packet payloads are
exchanged over the encrypted TLS tunnel.  In RADIUS/UDP, the
packet size can be determined by evaluating the size of the
datagram that arrived.  Due to the stream nature of TCP and TLS,
this does not hold true for RADIUS/TLS packet exchange.
Instead, packet boundaries of RADIUS packets that arrive in the
stream are calculated by evaluating the packet's Length field.
Special care needs to be taken on the packet sender side that
the value of the Length field is indeed correct before sending
it over the TLS tunnel, because incorrect packet lengths can no
longer be detected by a differing datagram boundary.  See
Section 2.6.4 of <span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span> for more details.<a href="#section-3.4-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.3">(2)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-1.4">
            <p id="section-3.4-1.4.1">Within RADIUS/UDP <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span>, a shared secret is used for hiding
attributes such as User-Password, as well as in computation of
the Response Authenticator.  In RADIUS accounting <span>[<a href="#RFC2866" class="cite xref">RFC2866</a>]</span>, the
shared secret is used in computation of both the Request
Authenticator and the Response Authenticator.  Since TLS
provides integrity protection and encryption sufficient to
substitute for RADIUS application-layer security, it is not
necessary to configure a RADIUS shared secret.  The use of a
fixed string for the obsolete shared secret eliminates possible
node misconfigurations.<a href="#section-3.4-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.5">(3)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-1.6">
            <p id="section-3.4-1.6.1">RADIUS/UDP <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> uses different UDP ports for
authentication, accounting, and dynamic authorization changes.
RADIUS/TLS allocates a single port for all RADIUS packet types.
Nevertheless, in RADIUS/TLS, the notion of a client that sends
authentication requests and processes replies associated with
its users' sessions and the notion of a server that receives
requests, processes them, and sends the appropriate replies is
to be preserved.  The normative rules about acceptable packet
types for clients and servers mirror the packet flow behavior
from RADIUS/UDP.<a href="#section-3.4-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.7">(4)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-1.8">
            <p id="section-3.4-1.8.1">RADIUS/UDP <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> uses negative ICMP responses to a newly
allocated UDP port to signal that a peer RADIUS server does not
support the reception and processing of the packet types in
<span>[<a href="#RFC5176" class="cite xref">RFC5176</a>]</span>.  These packet types are listed as to be received in
RADIUS/TLS implementations.  Note well: it is not required for
an implementation to actually process these packet types; it is
only required that the NAK be sent as defined above.<a href="#section-3.4-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-1.9">(5)</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-1.10">
            <p id="section-3.4-1.10.1">RADIUS/UDP <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span> uses negative ICMP responses to a newly
allocated UDP port to signal that a peer RADIUS server does not
support the reception and processing of RADIUS Accounting
packets.  There is no RADIUS datagram to signal an Accounting
NAK.  Clients may be misconfigured for sending Accounting
packets to a RADIUS/TLS server that does not wish to process
their Accounting packet.  To prevent a regression of
detectability of this situation, the Accounting-Response +
Error-Cause signaling was introduced.<a href="#section-3.4-1.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="compatibility-with-other-radius-transports">
<section id="section-4">
      <h2 id="name-compatibility-with-other-ra">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-compatibility-with-other-ra" class="section-name selfRef">Compatibility with Other RADIUS Transports</a>
      </h2>
<p id="section-4-1">The IETF defines multiple alternative transports to the classic UDP transport model as defined in <span>[<a href="#RFC2865" class="cite xref">RFC2865</a>]</span>, namely RADIUS over TCP <span>[<a href="#RFC6613" class="cite xref">RFC6613</a>]</span>, the present document on RADIUS over TLS and RADIUS over Datagram Transport Layer Security (DTLS) <span>[<a href="#RFC7360" class="cite xref">RFC7360</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">RADIUS/TLS does not specify any inherent backward compatibility to RADIUS/UDP or cross compatibility to the other transports, i.e., an implementation that utilizes RADIUS/TLS only will not be able to receive or send RADIUS packet payloads over other transports.
An implementation wishing to be backward or cross compatible (i.e., wishes to serve clients using other transports than RADIUS/TLS) will need to implement these other transports along with the RADIUS/TLS transport and be prepared to send and receive on all implemented transports, which is called a "multi-stack implementation".<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">If a given IP device is able to receive RADIUS payloads on multiple transports, this may or may not be the same instance of software, and it may or may not serve the same purposes.
It is not safe to assume that both ports are interchangeable.
In particular, it cannot be assumed that state is maintained for the packet payloads between the transports.
Two such instances <span class="bcp14">MUST</span> be considered separate RADIUS server entities.<a href="#section-4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">The computational resources to establish a TLS tunnel are significantly higher than simply sending mostly unencrypted UDP datagrams.
Therefore, clients connecting to a RADIUS/TLS node will more easily create high load conditions and a malicious client might create a Denial-of-Service attack more easily.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Some TLS cipher suites only provide integrity validation of their payload and provide no encryption.
This specification forbids the use of such cipher suites.
Since the RADIUS payload's shared secret is fixed to the well-known term "radsec", failure to comply with this requirement will expose the entire datagram payload in plaintext, including User-Password, to intermediate IP nodes.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">By virtue of being based on TCP, there are several generic attack vectors to slow down or prevent the TCP connection from being established; see <span>[<a href="#RFC4953" class="cite xref">RFC4953</a>]</span> for details.
If a TCP connection is not up when a packet is to be processed, it gets re-established, so such attacks in general lead only to a minor performance degradation (the time it takes to re-establish the connection).
There is one notable exception where an attacker might create a bidding-down attack though.
If peer communication between two devices is configured for both RADIUS/TLS and RADIUS/UDP, and the RADIUS/UDP transport is the failover option if the TLS session cannot be established, a bidding-down attack can occur if an adversary can maliciously close the TCP connection or prevent it from being established.
Situtations where clients are configured in such a way are likely to occur during a migration phase from RADIUS/UDP to RADIUS/TLS.
By preventing the TLS session setup, the attacker can reduce the security of the packet payload from the selected TLS cipher suite packet encryption to the classic MD5 per-attribute encryption.
The situation should be avoided by disabling the weaker RADIUS/UDP transport as soon as the new RADIUS/TLS connection is established and tested.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">RADIUS/TLS provides authentication and encryption between RADIUS peers.
In the presence of proxies, the intermediate proxies can still inspect the individual RADIUS packets, i.e., "end-to-end" encryption is not provided.
Where intermediate proxies are untrusted, it is desirable to use other RADIUS mechanisms to prevent RADIUS packet payload from inspection by such proxies.
One common method to protect passwords is the use of the Extensible Authentication Protocol (EAP) and EAP methods that utilize TLS.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">When using certificate fingerprints to identify RADIUS/TLS peers, any two certificates that produce the same hash value (i.e., that have a hash collision) will be considered the same client.
Therefore, it is important to make sure that the hash function used is cryptographically uncompromised so that an attacker is very unlikely to be able to produce a hash collision with a certificate of his choice.
While this specification mandates support for SHA-1, a later revision will likely demand support for more contemporary hash functions because as of issuance of this document, there are already attacks on SHA-1.<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">Upon approval, IANA should update the Reference to radsec in the Service Name and Transport Protocol Port Number Registry:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">Service Name: radsec<a href="#section-6-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.2">Port Number: 2083<a href="#section-6-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.3">Transport Protocol: tcp<a href="#section-6-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.4">Description: Secure RADIUS Service<a href="#section-6-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-6-2.5">Assignment notes: The TCP port 2083 was already previously assigned by IANA for "RadSec", an early implementation of RADIUS/TLS, prior to issuance of the experimental RFC 6614. [This document] updates RFC 6614, while maintaining backward compatibility, if configured. For further details see RFC 6614, Appendix A or [This document], <a href="#BackwardComp" class="auto internal xref">Appendix C</a>.<a href="#section-6-2.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2865">[RFC2865]</dt>
        <dd>
<span class="refAuthor">Rigney, C.</span>, <span class="refAuthor">Willens, S.</span>, <span class="refAuthor">Rubens, A.</span>, and <span class="refAuthor">W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2865">https://www.rfc-editor.org/rfc/rfc2865</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2866">[RFC2866]</dt>
        <dd>
<span class="refAuthor">Rigney, C.</span>, <span class="refTitle">"RADIUS Accounting"</span>, <span class="seriesInfo">RFC 2866</span>, <span class="seriesInfo">DOI 10.17487/RFC2866</span>, <time datetime="2000-06" class="refDate">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2866">https://www.rfc-editor.org/rfc/rfc2866</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6066">https://www.rfc-editor.org/rfc/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6613">[RFC6613]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"RADIUS over TCP"</span>, <span class="seriesInfo">RFC 6613</span>, <span class="seriesInfo">DOI 10.17487/RFC6613</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6613">https://www.rfc-editor.org/rfc/rfc6613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7250">[RFC7250]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[RFC9325]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9325">https://www.rfc-editor.org/rfc/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4953">[RFC4953]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refTitle">"Defending TCP Against Spoofing Attacks"</span>, <span class="seriesInfo">RFC 4953</span>, <span class="seriesInfo">DOI 10.17487/RFC4953</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4953">https://www.rfc-editor.org/rfc/rfc4953</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5176">[RFC5176]</dt>
        <dd>
<span class="refAuthor">Chiba, M.</span>, <span class="refAuthor">Dommety, G.</span>, <span class="refAuthor">Eklund, M.</span>, <span class="refAuthor">Mitton, D.</span>, and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 5176</span>, <span class="seriesInfo">DOI 10.17487/RFC5176</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5176">https://www.rfc-editor.org/rfc/rfc5176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5247">https://www.rfc-editor.org/rfc/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6614">[RFC6614]</dt>
        <dd>
<span class="refAuthor">Winter, S.</span>, <span class="refAuthor">McCauley, M.</span>, <span class="refAuthor">Venaas, S.</span>, and <span class="refAuthor">K. Wierenga</span>, <span class="refTitle">"Transport Layer Security (TLS) Encryption for RADIUS"</span>, <span class="seriesInfo">RFC 6614</span>, <span class="seriesInfo">DOI 10.17487/RFC6614</span>, <time datetime="2012-05" class="refDate">May 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6614">https://www.rfc-editor.org/rfc/rfc6614</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7360">[RFC7360]</dt>
        <dd>
<span class="refAuthor">DeKok, A.</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) as a Transport Layer for RADIUS"</span>, <span class="seriesInfo">RFC 7360</span>, <span class="seriesInfo">DOI 10.17487/RFC7360</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7360">https://www.rfc-editor.org/rfc/rfc7360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7585">[RFC7585]</dt>
        <dd>
<span class="refAuthor">Winter, S.</span> and <span class="refAuthor">M. McCauley</span>, <span class="refTitle">"Dynamic Peer Discovery for RADIUS/TLS and RADIUS/DTLS Based on the Network Access Identifier (NAI)"</span>, <span class="seriesInfo">RFC 7585</span>, <span class="seriesInfo">DOI 10.17487/RFC7585</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7585">https://www.rfc-editor.org/rfc/rfc7585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7593">[RFC7593]</dt>
      <dd>
<span class="refAuthor">Wierenga, K.</span>, <span class="refAuthor">Winter, S.</span>, and <span class="refAuthor">T. Wolniewicz</span>, <span class="refTitle">"The eduroam Architecture for Network Roaming"</span>, <span class="seriesInfo">RFC 7593</span>, <span class="seriesInfo">DOI 10.17487/RFC7593</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7593">https://www.rfc-editor.org/rfc/rfc7593</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="lessons-learned-from-deployments-of-the-experimental-rfc6614">
<section id="appendix-A">
      <h2 id="name-lessons-learned-from-deploy">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-lessons-learned-from-deploy" class="section-name selfRef">Lessons learned from deployments of the Experimental <em class="cite xref">[RFC6614]</em></a>
      </h2>
<p id="appendix-A-1">There are at least two major (world-scale) deployments of <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="eduroam">
<section id="appendix-A.1">
        <h3 id="name-eduroam">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-eduroam" class="section-name selfRef">eduroam</a>
        </h3>
<p id="appendix-A.1-1">eduroam is a globally operating Wi-Fi roaming consortium exclusively for persons in Research and Education. For an extensive background on eduroam and its authentication fabric architecture, refer to <span>[<a href="#RFC7593" class="cite xref">RFC7593</a>]</span>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Over time, more than a dozen out of 100+ national branches of eduroam used RADIUS/TLS in production to secure their country-to-country RADIUS proxy connections. This number is big enough to attest that the protocol does work, and scales. The number is also low enough to wonder why RADIUS/UDP continued to be used by a majority of country deployments despite its significant security issues.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Operational experience reveals that the main reason is related to the choice of PKIX certificates for securing the proxy interconnections. Compared to shared secrets, certificates are more complex to handle in multiple dimensions:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-4.1">Lifetime: PKIX certificates have an expiry date, and need administrator attention and expertise for their renewal<a href="#appendix-A.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-4.2">Validation: The validation of a certificate (both client and server) requires contacting a third party to verify the recovaction status. This either takes time during session setup (OCSP checks) or requires the presence of a fresh CRL on the server - this in turn requires regular update of that CRL.<a href="#appendix-A.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-4.3">Issuance: PKIX certificates carry properties in the Subject and extensions that need to be vetted. Depending on the CA policy, a certificate request may need significant human intervention to be verified. In particular, the authorisation of a requester to operate a server for a particular NAI realm needs to be verified. This rules out public "browser-trusted" CAs; eduroam is operating a special-purpose CA for eduroam RADIUS/TLS purposes.<a href="#appendix-A.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-4.4">Automatic failure over time: CRL refresh and certificate renewal must be attended to regularly. Failure to do so leads to failure of the authentication service. Among other reasons, employee churn with incorrectly transferred or forgotten responsibilities is a risk factor.<a href="#appendix-A.1-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.1-5">It appears that these complexities often outweigh the argument of improved security; and a fallback to RADIUS/UDP is seen as the more appealing option.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6">It can be considered an important result of the experiment in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> that providing less complex ways of operating RADIUS/TLS are required. The more thoroughly specified provisions in the current document towards TLS-PSK and raw public keys are a response to this insight.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">On the other hand, using RADIUS/TLS in combination with Dynamic Discovery as per <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> necessitates the use of PKIX certificates. So, the continued ability to operate with PKIX certificates is also important and cannot be discontinued without sacrificing vital funcionality of large roaming consortia.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wireless-broadband-alliances-openroaming">
<section id="appendix-A.2">
        <h3 id="name-wireless-broadband-alliance">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-wireless-broadband-alliance" class="section-name selfRef">Wireless Broadband Alliance's OpenRoaming</a>
        </h3>
<p id="appendix-A.2-1">OpenRoaming is a globally operating Wi-Fi roaming consortium for the general public, operated by the Wireless Broadband Alliance (WBA). With its (optional) settled usage of hotspots, the consortium requires both RADIUS authentication as well as RADIUS accounting.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The consortium operational procedures were defined in the late 2010s when <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> and <span>[<a href="#RFC7585" class="cite xref">RFC7585</a>]</span> were long available. The consortium decided to fully base itself on these two RFCs.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">In this architecture, using PSKs or raw public keys is not an option. The complexities around PKIX certificates as discussed in the previous section are believed to be controllable: the consortium operates its own special-purpose CA and can rely on a reliable source of truth for operator authorisation (becoming an operator requires a paid membership in WBA); expiry and revocation topics can be expected to be dealt with as high-priority because of the monetary implications in case of infrastructure failure during settled operation.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="participating-in-more-than-one-roaming-consortium">
<section id="appendix-A.3">
        <h3 id="name-participating-in-more-than-">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-participating-in-more-than-" class="section-name selfRef">Participating in more than one roaming consortium</a>
        </h3>
<p id="appendix-A.3-1">It is possible for a RADIUS/TLS (home) server to participate in more than one roaming consortium, i.e. to authenticate its users to multiple clients from distinct consortia, which present client certificates from their respective consortium's CA; and which expect the server to present a certificate from the matching CA.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">The eduroam consortium has chosen to cooperate with (the settlement-free parts of) OpenRoaming to allow eduroam users to log in to (settlement-free) OpenRoaming hotspots.<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3-3">eduroam RADIUS/TLS servers thus may be contacted by OpenRoaming clients expecting an OpenRoaming server certificate, and by eduroam clients expecting an eduroam server certificate.<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3-4">It is therefore necessary to decide on the certificate to present during TLS session establishment. To make that decision, the availability of Trusted CA Indication in the client TLS message is important.<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3-5">It can be considered an important result of the experiment in <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> that Trusted CA Indication is an important asset for inter-connectivity of multiple roaming consortia.<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="interoperable-implementations">
<section id="appendix-B">
      <h2 id="name-interoperable-implementatio">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-interoperable-implementatio" class="section-name selfRef">Interoperable Implementations</a>
      </h2>
<p id="appendix-B-1"><span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> is implemented and interoperates between at least three server implementations: FreeRADIUS, radsecproxy, Radiator. It is also implemented among a number of Wireless Access Points / Controllers from numerous vendors, including but not limited to: Aruba Networks, LANCOM Systems.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="BackwardComp">
<section id="appendix-C">
      <h2 id="name-backward-compatibility">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-backward-compatibility" class="section-name selfRef">Backward compatibility</a>
      </h2>
<p id="appendix-C-1">TODO describe necessary steps to configure common servers for compatibility with this version.
Hopefully the differences to <span>[<a href="#RFC6614" class="cite xref">RFC6614</a>]</span> are small enough that almost no config change is necessary.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">Thanks to the original authors of RFC 6614: Stefan Winter, Mike McCauley, Stig Venaas and Klaas Vierenga.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">TODO more acknowledgements<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jan-Frederik Rieckers (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Deutsches Forschungsnetz | German National Research and Education Network</span></div>
<div dir="auto" class="left"><span class="street-address">Alexanderplatz 1</span></div>
<div dir="auto" class="left">
<span class="postal-code">10178</span> <span class="locality">Berlin</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rieckers@dfn.de" class="email">rieckers@dfn.de</a>
</div>
<div class="url">
<span>URI:</span>
<a href="www.dfn.de" class="url">www.dfn.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Winter</span></div>
<div dir="auto" class="left"><span class="org">Fondation Restena | Restena Foundation</span></div>
<div dir="auto" class="left"><span class="street-address">2, avenue de l'Université</span></div>
<div dir="auto" class="left">L-<span class="postal-code">4365</span> <span class="locality">Esch-sur-Alzette</span>
</div>
<div dir="auto" class="left"><span class="country-name">Luxembourg</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.winter@restena.lu" class="email">stefan.winter@restena.lu</a>
</div>
<div class="url">
<span>URI:</span>
<a href="www.restena.lu" class="url">www.restena.lu</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
